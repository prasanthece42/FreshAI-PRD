(()=>{var e={};e.id=319,e.ids=[319],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29405:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>h,routeModule:()=>x,serverHooks:()=>w,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>m});var t={};s.r(t),s.d(t,{POST:()=>c});var a=s(96559),i=s(48088),o=s(37719),n=s(86345),u=s(32190);let p=(0,n.UU)("https://tqfenmgbraaathkpnqga.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxZmVubWdicmFhYXRoa3BucWdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUyNjY2NDQsImV4cCI6MjA2MDg0MjY0NH0.Tr3ryvrhmffrdMfw4HtQz4Uo-_bvJvbcicg0XajGrE8");async function c(e){try{let{token:r,password:s}=await e.json(),{data:t,error:a}=await p.from("password_resets").select("*").eq("token",r).single();if(a||!t)return u.NextResponse.json({message:"Invalid or expired token"},{status:400});let i=new Date;if(new Date(t.expires_at)<i)return u.NextResponse.json({message:"Token has expired"},{status:400});let o=await d(s),{error:n}=await p.from("users").update({password:o}).eq("id",t.user_id);if(n)return u.NextResponse.json({message:"Failed to update password"},{status:500});return await p.from("password_resets").delete().eq("token",r),u.NextResponse.json({message:"Password reset successful"},{status:200})}catch(e){return console.error("Password reset error:",e),u.NextResponse.json({message:"Internal server error"},{status:500})}}async function d(e){return(await s.e(663).then(s.bind(s,85663))).hash(e,10)}let x=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/reset-password/route",pathname:"/api/reset-password",filename:"route",bundlePath:"app/api/reset-password/route"},resolvedPagePath:"/Users/prasanthsivanandam/Desktop/2025/Final/FreshAI/freshai-next/src/app/api/reset-password/route.js",nextConfigOutput:"",userland:t}),{workAsyncStorage:l,workUnitAsyncStorage:m,serverHooks:w}=x;function h(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:m})}},34631:e=>{"use strict";e.exports=require("tls")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[719,495,190],()=>s(29405));module.exports=t})();